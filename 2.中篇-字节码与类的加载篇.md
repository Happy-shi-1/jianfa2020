<img src="http://ww1.sinaimg.cn/large/c02113bfgy1gj0j1mj4ccj21k60oenbb.jpg"/>
# 第一章：Class文件结构

## 1.概述

### 1.1 字节码文件的跨平台性

![image-20200922211534836](2.中篇-字节码与类的加载篇.assets/image-20200922211534836.png)





###1.2 Java的前端编译器

![image-20200922201654463](2.中篇-字节码与类的加载篇.assets/image-20200922201654463.png)



![image-20200922201513356](2.中篇-字节码与类的加载篇.assets/image-20200922201513356.png)

- IntelliJ IDEA使用的是javac编译器，是全量编译，比增量式编译器要慢
- AOT：在运行之前，直接将字节码文件编译成计算机可以运行的二进制文件，执行效率高些







###1.3 透过字节码指令看代码细节

![image-20200922202012042](2.中篇-字节码与类的加载篇.assets/image-20200922202012042.png)

- 通过查看源代码：int有一个-128～127的缓存数组，当值在其间的时候，不会new对象，而是直接将堆中的内容对象赋值给变量。
- 所以，结果为`true`和`false`。

![image-20200922205049172](2.中篇-字节码与类的加载篇.assets/image-20200922205049172.png)

- 结果为：`false`和`false`

![image-20200922205317847](2.中篇-字节码与类的加载篇.assets/image-20200922205317847.png)

- 结果为：`Son.x=0`,`Son.x=30`,`20`。
- 属性不存在多态性

- 成员变量（非静态的）的赋值过程： ① 默认初始化 - ② 显式初始化 /代码块中初始化 - ③ 构造器中初始化 - ④ 有了对象之后，可以“对象.属性”或"对象.方法"
   的方式对成员变量进行赋值。
- 构造子类对象的时候，会先加载父类再加载子类，加载父类的时候先执行显示初始化变量，然后构造器初始化（其中this调用方法是子类重写的）；然后子类也是先执行显示初始化变量，然后构造器初始化





##2.虚拟机的基石：Class文件

![image-20200922212209603](2.中篇-字节码与类的加载篇.assets/image-20200922212209603.png)

- 源代码生成的字节码文件的个数取决于其中类的个数，即是是内部类也会生成字节码文件
- 上述中的JVM指令就是指字节码文件

![image-20200922213000788](2.中篇-字节码与类的加载篇.assets/image-20200922213000788.png) ![image-20200922213026660](2.中篇-字节码与类的加载篇.assets/image-20200922213026660.png)



##3.Class文件结构

![image-20200922235443356](2.中篇-字节码与类的加载篇.assets/image-20200922235443356.png)

![image-20200923000234319](2.中篇-字节码与类的加载篇.assets/image-20200923000234319.png)

###3.1 魔数



![13431600791205_.pic_hd.jpg](2.中篇-字节码与类的加载篇.assets/c02113bfgy1gizwdv3mopj21840m8gx2.jpg)





<img src="http://ww1.sinaimg.cn/large/c02113bfgy1gizwdv3mopj21840m8gx2.jpg"/>





![13431600791205_.pic_hd.jpg](2.中篇-字节码与类的加载篇.assets/c02113bfgy1gizwdv3mopj21840m8gx2-20200923003706208.jpg)
